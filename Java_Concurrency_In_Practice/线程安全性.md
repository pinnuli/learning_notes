### 什么是线程安全性
**当多个线程访问某个类时**，不管运行时环境采用何种调度方式或者这些线程将如何交替执行，并且在主调代码中不需要任何额外的同步或协同，**这个类都能表现出正确的行为**，那么就称这个类是线程安全的.

### 原子性
#### 竞态条件
当两个线程竞争同一资源时，如果对资源的访问顺序敏感，即结果的正确性取决于多个线程的交替执行时序，就称存在 **竞态条件**。导致竞态条件发生的代码区称作 **临界区**。

#### 常见的存在竞态条件的类型
- **先检查后执行**：基于一种可能失效的观察结果来做出判断或者执行某个计算：if(condition){}
- **读取-修改-写入**: count++

#### 复合操作
**复合操作**：包含了一组必须以原子方式执行的操作，以确保线程安全性。

### 由锁来保护状态
- 每个共享的和可变的变量都应该只由一个锁来保护，从而使维护人员知道是哪一个锁
- 对于每个包含多个变量的不变性条件，其中涉及的所有变量都需要由同一个锁来保护
- 要判断同步代码块的合理大小，需要在各种设计需求之间进行权衡，包括安全性、简单性和性能
- 当执行时间较长的计算或者可能无法快四完成的操作时，一定不要持有锁

